<script>
function calc() {
    var brandBaseKcal = parseFloat(document.getElementById('brand').value);
    var formulaMod = parseFloat(document.getElementById('formulaType').value);
    var stageMultiplier = parseFloat(document.getElementById('stage').value);
    var p = parseFloat(document.getElementById('peso').value);
    var u = document.getElementById('unit').value;
    var r = document.getElementById('res');

    var kcalPerCup = brandBaseKcal * formulaMod;

    if(p > 0) {
        var pesoKg = (u === "lb") ? (p / 2.20462) : p;
        var dailyKcal = (30 * pesoKg + 70) * stageMultiplier;
        var cups = dailyKcal / kcalPerCup;
        var grams = cups * 105; 

        r.style.display = 'block';
        r.innerHTML = `
            <div style="font-size: 13px; color: #666; font-weight: bold; text-transform: uppercase;">
                Total Daily Serving / Ración Diaria Total
            </div>
            <div style="font-size: 32px; font-weight: bold; color: #854d0e; margin: 5px 0;">
                ${cups.toFixed(1)} cups
            </div>
            <div style="font-size: 16px; color: #a16207; margin-bottom: 12px;">
                (aprox. ${Math.round(grams)} gramos)
            </div>
            
            <div style="font-size: 13px; color: #854d0e; border-top: 1px solid #fde68a; padding-top: 10px; background: rgba(253, 230, 138, 0.2); border-radius: 8px;">
                <strong>Suggested / Sugerencia:</strong><br>
                ${(cups/2).toFixed(2)} cups per meal (2 meals a day)<br>
                <span style="font-size: 11px; opacity: 0.8;">${(cups/2).toFixed(2)} tazas por porción (2 veces al día)</span>
            </div>

            <p style="font-size: 10px; color: #999; margin-top: 15px; line-height: 1.2; font-style: italic;">
                *Disclaimer: Nutritional estimate. Not a substitute for veterinary advice.<br>
                *Aviso: Estimación nutricional. No reemplaza la consulta veterinaria.
            </p>
        `;

        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });

    } else {
        alert(u === "kg" ? "Por favor, ingresa el peso." : "Please enter a weight.");
    }
}
</script>
